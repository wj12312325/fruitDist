"use strict";(self["webpackChunkfruit_netshop"]=self["webpackChunkfruit_netshop"]||[]).push([[88],{2088:function(t,e,s){s.r(e),s.d(e,{default:function(){return l}});var r=function(){var t=this,e=t._self._c;return e("div",{staticClass:"order-right"},[e("div",{staticClass:"order-content"},[t._m(0),t._m(1),e("div",{staticClass:"orders"},t._l(t.orderList,(function(s){return e("table",{key:s.id,staticClass:"order-item"},[e("thead",[e("tr",[e("th",{attrs:{colspan:"5"},on:{click:function(e){return t.toPay(s)}}},[e("span",{staticClass:"ordertitle"},[t._v(t._s(t.orderDate(s.createdAt))+"          订单编号："+t._s(s.order_number)+" ")])])])]),e("tbody",t._l(s.goods_info,(function(r,a){return e("tr",{key:r.id},[e("td",{attrs:{width:"59%"},on:{click:function(e){return t.toPay(s)}}},[e("div",{staticClass:"typographic"},[e("img",{staticStyle:{height:"100px",width:"100px"},attrs:{src:`${t.srcUrl}${r.goods_img[0]}`}}),e("a",{staticClass:"block-text"},[t._v(t._s(r.goods_name))]),e("span",{staticClass:"number"},[t._v("x"+t._s(r.number))])])]),e("td",{directives:[{name:"show",rawName:"v-show",value:0==a,expression:"index == 0"}],staticClass:"center",attrs:{rowspan:s.goods_info.length,width:"9%"},on:{click:function(e){return t.toPay(s)}}},[t._v(" "+t._s(s.addressInfo.consignee)+" ")]),e("td",{directives:[{name:"show",rawName:"v-show",value:0==a,expression:"index == 0"}],staticClass:"center",attrs:{rowspan:s.goods_info.length,width:"11%"}},[e("ul",{staticClass:"unstyled"},[e("li",{on:{click:function(e){return t.toPay(s)}}},[t._v("¥"+t._s(s.total))])])]),e("td",{directives:[{name:"show",rawName:"v-show",value:0==a,expression:"index == 0"}],staticClass:"center",attrs:{rowspan:s.goods_info.length,width:"10%"}},[e("a",{staticClass:"btn",on:{click:function(e){return t.toPay(s)}}},[t._v(t._s(t.orderStatus(s.status))+" ")])]),e("td",{directives:[{name:"show",rawName:"v-show",value:0==a,expression:"index == 0"}],staticClass:"center",attrs:{rowspan:s.goods_info.length,width:"13%"}},[e("div",{staticStyle:{"margin-bottom":"10px"}},[e("el-button",{attrs:{type:"primary",disabled:4==s.status},on:{click:function(e){return t.cancelOrder(s)}}},[t._v("取消订单")])],1),e("div",{staticClass:"deletedBtn"},[e("el-popconfirm",{attrs:{title:"确定要删除吗？"},on:{confirm:function(e){return t.deleteOrder(s)}}},[e("el-button",{attrs:{slot:"reference",type:"danger"},slot:"reference"},[t._v("删除订单")])],1)],1)])])})),0)])})),0),e("div",{staticClass:"pagination"},[e("div",[e("el-pagination",{attrs:{"current-page":t.pageNum,"page-sizes":[3,5,10],"page-size":t.pageSize,layout:" prev, pager,  next, sizes,jumper,->,total",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)])])])},a=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"title"},[e("h3",[t._v("我的订单")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"chosetype"},[e("table",[e("thead",[e("tr",[e("th",{staticClass:"th1",attrs:{width:"29%"}},[t._v("商品")]),e("th",{staticClass:"th2",attrs:{width:"30%"}},[t._v("订单详情")]),e("th",{attrs:{width:"12%"}},[t._v("收货人")]),e("th",[t._v("金额")]),e("th",[t._v("状态")]),e("th",[t._v("操作")])])])])])}],i=(s(7658),s(3822)),n={name:"myOrder",data(){return{pageNum:1,pageSize:3}},methods:{async getMyOrderList(){const t=this.$route.params.status,{pageNum:e,pageSize:s}=this;let r={pageNum:e,pageSize:s};void 0!==t&&(r={pageNum:e,pageSize:s,status:t}),await this.$store.dispatch("order/getOrderList",r)},handleSizeChange(t){this.pageSize=t,this.getMyOrderList()},handleCurrentChange(t){this.pageNum=t,this.getMyOrderList()},orderStatus(t){switch(t){case 0:return"未支付";case 1:return"已支付";case 2:return"已发货";case 3:return"已签收";case 4:return"取消"}},orderDate(t){return this.dayjs(t).format("YYYY-MM-DD HH:mm:ss")},deleteOrder(t){if(1!=t.status&&2!=t.status)try{let e={ids:[t.id]};this.$store.dispatch("order/deleteOrder",e),this.pageNum=1,this.getMyOrderList(),this.$message({type:"success",message:"删除订单成功"})}catch(e){this.$message({type:"error",message:e})}else this.$message({type:"warning",message:"订单正在发货或在运输途中，无法删除该订单"})},toPay(t){0==t.status&&this.$router.push(`/pay?orderId=${t.id}&&totalFee=${t.total}`)},async updateGoods(t){for(let s of t){let t=0;t=s.goods_num+1*s.number;let r={id:s.id,goods_num:t};try{await this.$store.dispatch("goods/updateGoods",r)}catch(e){this.$message({type:"error",message:e})}}},cancelOrder(t){this.$confirm(`确定取消订单号'${t.order_number}'这个订单吗?`,"提示",{type:"warning"}).then((async()=>{let e={id:t.id,data:{status:4}};await this.$store.dispatch("order/updateOrder",e),this.$message({type:"success",message:"取消订单成功"}),this.updateGoods(t.goods_info),this.getMyOrderList()})).catch((t=>{"cancel"==t?this.$message.info("已取消"):this.$message({type:"error",message:t})}))}},mounted(){this.getMyOrderList()},computed:{...(0,i.rn)({orderList:t=>t.order.orderList||[],total:t=>t.order.total||null})}},o=n,d=s(1001),c=(0,d.Z)(o,r,a,!1,null,"7d4f471c",null),l=c.exports}}]);
//# sourceMappingURL=88.66c20a03.js.map