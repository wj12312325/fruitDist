"use strict";(self["webpackChunkfruit_netshop"]=self["webpackChunkfruit_netshop"]||[]).push([[508],{508:function(t,s,e){e.r(s),e.d(s,{default:function(){return g}});var a=function(){var t=this,s=t._self._c;return s("div",{staticClass:"cart"},[s("div",{staticClass:"a"},[s("div",{staticClass:"b"},[s("h4",[t._v("全部商品")]),s("div",{staticClass:"cart-main"},[t._m(0),s("div",{staticClass:"cart-body"},t._l(t.cartList,(function(e){return s("ul",{key:e.id,staticClass:"cart-list"},[s("li",{staticClass:"cart-list-con1"},[s("input",{attrs:{type:"checkbox",name:"chk_list"},domProps:{checked:1==e.selected},on:{change:function(s){return t.changeIsChecked(e,s)}}})]),s("li",{staticClass:"cart-list-con2"},[s("img",{attrs:{src:`http://localhost:8888/${e.goods_info.goods_img[0]}`}}),s("div",{staticClass:"item-msg"},[t._v(t._s(e.goods_info.goods_name))])]),s("li",{staticClass:"cart-list-con4"},[s("span",{staticClass:"price"},[t._v(t._s(e.goods_info.goods_price))])]),s("li",{staticClass:"cart-list-con5"},[s("el-input-number",{ref:"as",refInFor:!0,staticClass:"number",attrs:{min:1,max:e.goods_info.goods_num,size:"small"},on:{change:function(s){return t.handleChange(e.id,s)}},model:{value:e.number,callback:function(s){t.$set(e,"number",s)},expression:"cart.number"}})],1),s("li",{staticClass:"cart-list-con6"},[s("span",{staticClass:"sum"},[t._v(t._s(t.skuAllPrice(e)))])]),s("li",{staticClass:"cart-list-con7",on:{click:function(s){return t.deleteCartList(e)}}},[s("a",{staticClass:"sindelet"},[t._v("删除")]),s("br")])])})),0)]),s("img",{directives:[{name:"show",rawName:"v-show",value:t.cartList.length<=0,expression:"cartList.length <= 0"}],staticClass:"notCart",attrs:{src:e(4672)}}),s("div",{directives:[{name:"show",rawName:"v-show",value:t.cartList.length>0,expression:"cartList.length > 0"}],staticClass:"cart-tool"},[s("div",{staticClass:"select-all"},[s("input",{staticClass:"chooseAll",attrs:{type:"checkbox"},domProps:{checked:t.isAllChecked&&t.cartList.length>0},on:{change:t.changeAllcartIsChecked}}),s("span",[t._v("全选")])]),s("div",{staticClass:"option"},[s("a",{on:{click:t.deleteAllIsChecked}},[t._v("删除选中的商品")])]),s("div",{staticClass:"money-box"},[s("div",{staticClass:"chosed"},[t._v(" 已选择"),s("span",[t._v(t._s(t.selectedNum))]),t._v("件商品 ")]),s("div",{staticClass:"sumprice"},[s("div",[t._v("总价（元） ：")]),s("div",{staticClass:"summoney"},[t._v(t._s(t.selectedAllMoney))])]),s("div",{staticClass:"sumbtn",on:{click:t.toTrade}},[s("a",{staticClass:"sum-btn"},[t._v("结算")])])])])])])])},i=[function(){var t=this,s=t._self._c;return s("div",{staticClass:"cart-th"},[s("div",{staticClass:"cart-th1"},[t._v("全部")]),s("div",{staticClass:"cart-th2"},[t._v("商品")]),s("div",{staticClass:"cart-th3"},[t._v("单价（元）")]),s("div",{staticClass:"cart-th4"},[t._v("数量")]),s("div",{staticClass:"cart-th5"},[t._v("总计（元）")]),s("div",{staticClass:"cart-th6"},[t._v("操作")])])}],c=(e(7658),e(3822)),r=e(9289),l=e.n(r),n={name:"ShopCart",data(){return{}},mounted(){this.getShopCartData(),this.$message({type:"success",message:"获取购物车列表成功"})},beforeRouteEnter(t,s,e){e((t=>{if(-1!==s.path.indexOf("/login")){let s=100,e=1;t.$nextTick((()=>{let a=localStorage.getItem("ID");try{t.$store.dispatch("cart/getCartList",{id:a,pageSize:s,pageNum:e})}catch(i){}}))}}))},methods:{async getShopCartData(){const{id:t}=this;let s=100,e=1;try{await this.$store.dispatch("cart/getCartList",{id:t,pageSize:s,pageNum:e})}catch(a){}},skuAllPrice(t){return(t.number*t.goods_info.goods_price).toFixed(2)},handleChange:l()((async function(t,s){try{await this.$store.dispatch("cart/updateCart",{id:t,number:s}),this.$message({type:"success",message:"购物车数量修改成功"}),this.getShopCartData()}catch(e){this.$message({type:"error",message:e})}}),2e3),async deleteCartList(t){let s=[];s.push(t.id);let e={ids:s};this.$confirm(`确定删除 '${t.goods_info.goods_name}'这个购物车吗?`,"提示",{type:"warning"}).then((async()=>{await this.$store.dispatch("cart/deleteCart",e),this.getShopCartData(),this.$message({type:"success",message:"删除购物车成功"})})).catch((t=>{"cancel"==t?this.$message.info("已取消删除"):this.$message({type:"error",message:t})}))},changeIsChecked:l()((async function(t,s){let e=!!s.target.checked;try{await this.$store.dispatch("cart/updateCart",{id:t.id,selected:e}),this.$message({type:"success",message:"购物车状态修改成功"}),this.getShopCartData()}catch(a){this.$message({type:"error",message:a})}}),2e3),async changeAllcartIsChecked(t){try{let s=!!t.target.checked;await this.$store.dispatch("cart/selectAllorNull",{selectState:s}),this.getShopCartData();let e=s?"购物车全选成功":"购物车全取消成功";this.$message({type:"success",message:e}),this.getShopCartData()}catch(s){this.$message({type:"error",message:s})}},async deleteAllIsChecked(){let t=[];for(let e of this.cartList)e.selected&&t.push(e.id);let s={ids:t};this.$confirm(`确定删除这'${t.length}' 条购物车吗?`,"提示",{type:"warning"}).then((async()=>{await this.$store.dispatch("cart/deleteCart",s),this.getShopCartData(),this.$message({type:"success",message:"删除购物车成功"})})).catch((t=>{"cancel"==t?this.$message.info("已取消删除"):this.$message({type:"error",message:t})}))},async setDefault(t){try{await this.$store.dispatch("address/updateAddress",{id:t.id,data:{is_default:!0}})}catch(s){this.$message({type:"error",message:s})}},async toTrade(){await this.$store.dispatch("address/getAddressList",{pageNum:1,pageSize:1e4,user_id:this.id}),this.addressList.length<1?(this.$message({type:"warning",message:"还没有收货地址，请先添加收货地址"}),this.$router.push("/center/myaddress")):1==this.addressList.length&&0==this.addressList[0].is_default?(this.setDefault(this.addressList[0]),this.$router.push("/trade")):this.$router.push("/trade")}},computed:{...(0,c.rn)({id:t=>t.user.userInfo.id,cartList:t=>t.cart.cartList||[],addressList:t=>t.address.addressList||[]}),isAllChecked(){return this.cartList.every((t=>1==t.selected))},selectedNum(){let t=0;return this.cartList.forEach((s=>{s.selected&&t++})),t},selectedAllMoney(){let t=0;return this.cartList.forEach((s=>{s.selected&&(t+=s.number*s.goods_info.goods_price)})),t.toFixed(2)}}},o=n,d=e(1001),h=(0,d.Z)(o,a,i,!1,null,"20808284",null),g=h.exports},4672:function(t,s,e){t.exports=e.p+"img/notCart.7278c03b.png"}}]);
//# sourceMappingURL=508.3b8fd99d.js.map